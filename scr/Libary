-- =============================================
-- GROKUI v2 - Modernized Edition (Feb 2026)
-- Glassmorphism, gradients, glow, Lucide-ready
-- =============================================

local GrokUI = {}
local TS = game:GetService("TweenService")
local UIS = game:GetService("UserInputService")

local DEFAULT_THEME = {
    Accent       = Color3.fromRGB(90, 160, 255),
    Background   = Color3.fromRGB(16, 16, 24),
    Secondary    = Color3.fromRGB(24, 24, 38),
    Tertiary     = Color3.fromRGB(36, 36, 52),
    Text         = Color3.fromRGB(240, 240, 255),
    TextDim      = Color3.fromRGB(170, 170, 190),
    Border       = Color3.fromRGB(55, 55, 80),
    Shadow       = Color3.fromRGB(0,0,0),
}

function GrokUI:CreateWindow(options)
    options = options or {}
    local title     = options.Title or "GrokUI"
    local theme     = options.Theme or DEFAULT_THEME
    local sizeX     = options.SizeX or 720
    local sizeY     = options.SizeY or 520

    local sg = Instance.new("ScreenGui")
    sg.Name = "GrokUI_v2"
    sg.ResetOnSpawn = false
    sg.Parent = game:GetService("CoreGui")

    -- Main frame with gradient + stroke + shadow
    local Main = Instance.new("Frame")
    Main.Size = UDim2.new(0, sizeX, 0, sizeY)
    Main.Position = UDim2.new(0.5, -sizeX/2, 0.5, -sizeY/2)
    Main.BackgroundColor3 = theme.Background
    Main.BorderSizePixel = 0
    Main.ClipsDescendants = true
    Main.Parent = sg

    local corner = Instance.new("UICorner"); corner.CornerRadius = UDim.new(0,16); corner.Parent = Main

    local stroke = Instance.new("UIStroke")
    stroke.Color = theme.Border
    stroke.Thickness = 1.5
    stroke.Transparency = 0.4
    stroke.Parent = Main

    -- Gradient background
    local grad = Instance.new("UIGradient")
    grad.Color = ColorSequence.new{
        ColorSequenceKeypoint.new(0, Color3.fromRGB(35,35,50)),
        ColorSequenceKeypoint.new(1, theme.Background)
    }
    grad.Rotation = 90
    grad.Parent = Main

    -- Glow / shadow effect (UIStroke trick)
    local glow = Instance.new("UIStroke")
    glow.Color = theme.Accent
    glow.Thickness = 3
    glow.Transparency = 0.85
    glow.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    glow.Parent = Main

    -- Title bar
    local TitleBar = Instance.new("Frame")
    TitleBar.Size = UDim2.new(1,0,0,48)
    TitleBar.BackgroundColor3 = theme.Secondary
    TitleBar.BorderSizePixel = 0
    TitleBar.Parent = Main

    local tbCorner = Instance.new("UICorner"); tbCorner.CornerRadius = UDim.new(0,16); tbCorner.Parent = TitleBar

    local titleLbl = Instance.new("TextLabel")
    titleLbl.Size = UDim2.new(1,-140,1,0)
    titleLbl.Position = UDim2.new(0,20,0,0)
    titleLbl.BackgroundTransparency = 1
    titleLbl.Text = title
    titleLbl.TextColor3 = theme.Text
    titleLbl.Font = Enum.Font.GothamBlack
    titleLbl.TextSize = 19
    titleLbl.TextXAlignment = Enum.TextXAlignment.Left
    titleLbl.Parent = TitleBar

    -- Close button (red pill style)
    local close = Instance.new("TextButton")
    close.Size = UDim2.new(0,38,0,38)
    close.Position = UDim2.new(1,-48,0,5)
    close.BackgroundColor3 = Color3.fromRGB(235, 70, 70)
    close.Text = "Ã—"
    close.TextColor3 = Color3.new(1,1,1)
    close.Font = Enum.Font.GothamBold
    close.TextSize = 22
    close.Parent = TitleBar

    local clCorner = Instance.new("UICorner"); clCorner.CornerRadius = UDim.new(1,0); clCorner.Parent = close

    close.MouseButton1Click:Connect(function()
        sg:Destroy()
    end)

    -- Dragging
    local dragging, dragStart, startPos
    TitleBar.InputBegan:Connect(function(inp)
        if inp.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = inp.Position
            startPos = Main.Position
        end
    end)

    TitleBar.InputEnded:Connect(function(inp)
        if inp.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
        end
    end)

    UIS.InputChanged:Connect(function(inp)
        if dragging and inp.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = inp.Position - dragStart
            Main.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)

    -- Content
    local Content = Instance.new("Frame")
    Content.Size = UDim2.new(1,0,1,-48)
    Content.Position = UDim2.new(0,0,0,48)
    Content.BackgroundTransparency = 1
    Content.Parent = Main

    local TabBar = Instance.new("ScrollingFrame")
    TabBar.Size = UDim2.new(0,180,1,0)
    TabBar.BackgroundColor3 = theme.Tertiary
    TabBar.BorderSizePixel = 0
    TabBar.ScrollBarThickness = 4
    TabBar.ScrollBarImageColor3 = theme.Accent
    TabBar.CanvasSize = UDim2.new(0,0,0,0)
    TabBar.Parent = Content

    local tabList = Instance.new("UIListLayout")
    tabList.Padding = UDim.new(0,6)
    tabList.SortOrder = Enum.SortOrder.LayoutOrder
    tabList.Parent = TabBar

    local pad = Instance.new("UIPadding")
    pad.PaddingTop = UDim.new(0,12)
    pad.PaddingLeft = UDim.new(0,10)
    pad.PaddingRight = UDim.new(0,10)
    pad.Parent = TabBar

    local tabCorner = Instance.new("UICorner"); tabCorner.CornerRadius = UDim.new(0,14); tabCorner.Parent = TabBar

    local tabContent = Instance.new("Frame")
    tabContent.Size = UDim2.new(1,-180,1,0)
    tabContent.Position = UDim2.new(0,180,0,0)
    tabContent.BackgroundTransparency = 1
    tabContent.Parent = Content

    local tabs = {}
    local activeTab, activeBtn = nil, nil

    local Window = {}

    function Window:CreateTab(name, iconName)   -- iconName = "home", "settings", etc (for future Lucide)
        local tabBtn = Instance.new("TextButton")
        tabBtn.Size = UDim2.new(1,0,0,46)
        tabBtn.BackgroundColor3 = theme.Secondary
        tabBtn.Text = ""
        tabBtn.AutoButtonColor = false
        tabBtn.Parent = TabBar

        local btnCorner = Instance.new("UICorner"); btnCorner.CornerRadius = UDim.new(0,10); btnCorner.Parent = tabBtn

        -- Icon placeholder (replace with Lucide later)
        local icon = Instance.new("TextLabel")
        icon.Size = UDim2.new(0,32,0,32)
        icon.Position = UDim2.new(0,12,0.5,-16)
        icon.BackgroundTransparency = 1
        icon.Text = iconName and iconName:sub(1,1):upper() or "?"
        icon.TextColor3 = theme.TextDim
        icon.Font = Enum.Font.GothamBold
        icon.TextSize = 24
        icon.Parent = tabBtn

        local label = Instance.new("TextLabel")
        label.Size = UDim2.new(1,-60,1,0)
        label.Position = UDim2.new(0,54,0,0)
        label.BackgroundTransparency = 1
        label.Text = name
        label.TextColor3 = theme.TextDim
        label.TextXAlignment = Enum.TextXAlignment.Left
        label.Font = Enum.Font.GothamSemibold
        label.TextSize = 16
        label.Parent = tabBtn

        -- Tab content
        local frame = Instance.new("ScrollingFrame")
        frame.Size = UDim2.new(1,0,1,0)
        frame.BackgroundTransparency = 1
        frame.ScrollBarThickness = 5
        frame.ScrollBarImageColor3 = theme.Accent
        frame.Visible = false
        frame.Parent = tabContent

        local list = Instance.new("UIListLayout")
        list.Padding = UDim.new(0,10)
        list.SortOrder = Enum.SortOrder.LayoutOrder
        list.Parent = frame

        local pad2 = Instance.new("UIPadding")
        pad2.PaddingLeft = UDim.new(0,18)
        pad2.PaddingRight = UDim.new(0,18)
        pad2.PaddingTop = UDim.new(0,18)
        pad2.Parent = frame

        table.insert(tabs, {btn=tabBtn, frame=frame})

        tabBtn.MouseButton1Click:Connect(function()
            if activeTab then activeTab.Visible = false end
            if activeBtn then
                TS:Create(activeBtn, TweenInfo.new(0.25,Enum.EasingStyle.Quint), {BackgroundColor3 = theme.Secondary}):Play()
                activeBtn:FindFirstChild("TextLabel").TextColor3 = theme.TextDim
            end

            frame.Visible = true
            TS:Create(tabBtn, TweenInfo.new(0.25,Enum.EasingStyle.Quint), {BackgroundColor3 = theme.Accent}):Play()
            label.TextColor3 = Color3.new(1,1,1)

            activeTab = frame
            activeBtn = tabBtn
        end)

        -- Auto open first tab
        if #tabs == 1 then
            frame.Visible = true
            TS:Create(tabBtn, TweenInfo.new(0.1), {BackgroundColor3 = theme.Accent}):Play()
            label.TextColor3 = Color3.new(1,1,1)
            activeTab = frame
            activeBtn = tabBtn
        end

        tabBar.CanvasSize = UDim2.new(0,0,0, tabList.AbsoluteContentSize.Y + 24)

        local Tab = {}

        function Tab:CreateLabel(text)
            local lbl = Instance.new("TextLabel")
            lbl.Size = UDim2.new(1,0,0,28)
            lbl.BackgroundTransparency = 1
            lbl.Text = text
            lbl.TextColor3 = theme.Text
            lbl.Font = Enum.Font.Gotham
            lbl.TextSize = 15
            lbl.TextXAlignment = Enum.TextXAlignment.Left
            lbl.Parent = frame
            return lbl
        end

        function Tab:CreateButton(text, callback)
            local btn = Instance.new("TextButton")
            btn.Size = UDim2.new(1,0,0,48)
            btn.BackgroundColor3 = theme.Tertiary
            btn.Text = text
            btn.TextColor3 = theme.Text
            btn.Font = Enum.Font.GothamSemibold
            btn.TextSize = 16
            btn.Parent = frame

            local c = Instance.new("UICorner"); c.CornerRadius = UDim.new(0,12); c.Parent = btn

            local strk = Instance.new("UIStroke"); strk.Color = theme.Border; strk.Thickness = 1; strk.Parent = btn

            btn.MouseEnter:Connect(function()
                TS:Create(btn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(60,60,85)}):Play()
            end)
            btn.MouseLeave:Connect(function()
                TS:Create(btn, TweenInfo.new(0.2), {BackgroundColor3 = theme.Tertiary}):Play()
            end)

            btn.MouseButton1Click:Connect(function()
                TS:Create(btn, TweenInfo.new(0.1), {BackgroundColor3 = theme.Accent}):Play()
                task.delay(0.15, function()
                    TS:Create(btn, TweenInfo.new(0.25), {BackgroundColor3 = theme.Tertiary}):Play()
                end)
                if callback then callback() end
            end)

            return btn
        end

        -- Toggle & Slider remain similar but with better visuals (you can copy-paste & adjust colors from theme)

        -- ... (add Toggle, Slider, etc with theme colors)

        return Tab
    end

    function Window:Destroy()
        sg:Destroy()
    end

    return Window
end

return GrokUI
